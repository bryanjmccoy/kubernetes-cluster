#Contents generated by chef! Local changes will be overwritten next converge!

global
        maxconn 4096
        log   127.0.0.1       local0
        spread-checks 5
        daemon
        user nobody
        group nobody
        stats socket  /var/lib/haproxy/stats user root group root mode 700 level admin

defaults
        log global
        mode http
        balance leastconn
        maxconn 3072
        option httplog
        option dontlognull
        option abortonclose
        option httpclose
        retries 3
        option redispatch
        timeout client 1m
        timeout connect 10s
        timeout server 1m
        timeout check 10s

frontend api_frontend
        bind 0.0.0.0:443
        option tcplog
        mode tcp
        default_backend api_backend

backend api_backend
        balance roundrobin
        option ssl-hello-chk
        mode tcp
        server kube-master0 10.1.0.147:443 check
        server kube-master1 10.1.0.146:443 check
        server kube-master2 10.1.0.145:443 check